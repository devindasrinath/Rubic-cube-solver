y=[load("yellow_train.txt"), load("red_train.txt"),load("green_train.txt"),load("orange_train.txt"),load("white_train.txt"),load("blue_train.txt")]';x=(load("x.txt"))'/100;%x=[60;70;30;];Fsilent=10^(-4);%y=[1;0;0;0;0;0];Delta_1=0;Delta_2=0;samples=54;Theta_1=(rand(6,4)*2-1)*10^-5;a_1=x;a_2=ones(6,1);Theta_2=(rand(6,7)*2-1)*10^-5;a_3=ones(6,1);alpha=0.06;t=100000;costs=zeros(t,1);p=100000;%%%%%%%%%%%%%%forward propagationfor iterations=1:t  cost=0;  Delta_1=0;  Delta_2=0;  for sample=1:54    a_1=x(:,sample); 
    Z_2=Theta_1*[1;a_1]; %% 6x1    for i=1:6      a_2(i)=1/(1+e^(-Z_2(i,1)));    endfor    Z_3=Theta_2*[1;a_2];    for i=1:6      a_3(i)=1/(1+e^(-Z_3(i,1)));    endfor    %%%%%%%%%%%%bacward propergation    delta_3=a_3-y(:,sample);  % 6*1        delta_2=Theta_2'*delta_3.*[1;a_2].*(1-[1;a_2]); % 7*6  6*1  == 7*1        Delta_1=Delta_1+delta_2([2,3,4,5,6,7],1)*[1;a_1]';  %6*1  1*4 == 6*4     Delta_2=Delta_2+delta_3*[1;a_2]'; %6*1   1*7 ==6*7    cost+=((y(:,sample)'*log(a_3))+ ((1-y(:,sample))'*log(1-a_3)));  endfor  %U_T+heta_1=Theta_1;  Theta_1=Theta_1-alpha*Delta_1;  %U_Theta_2=Theta_2;  Theta_2=Theta_2-alpha*Delta_2;  iterations    cost=(-cost)/samples
  costs(iterations,1)=cost;endforplot([1:t],costs);Theta_1Theta_2##endfor##U_Theta_3=zeros(7,1);##for i=1;7:##  U_Theta_3(i)=U_Theta_3-alpha*Delata_2(i,1);##endfor####Theta_2=U_Theta_2;##Theta_3=U_Theta_3;?Theta_1 =                                                                                                                                                                           -3.0468e+00  -8.3589e+00  -3.4971e+00   9.0190e+00   1.0960e+00   3.7476e-02  -2.4735e+01   2.5292e+01   2.0517e+00  -1.2135e+01   5.4285e+00   8.5658e+00  -1.7409e+00  -1.1082e+01   5.5482e+00   4.0254e+00  -1.7092e+00  -1.0960e+01   5.5259e+00   3.9537e+00   2.3337e+00  -1.2883e+01   1.9973e+01  -4.8984e+00Theta_2 =  -8.9504e+00  -3.6778e+00  -1.4745e+01  -7.3389e+00  -8.5755e+00  -8.5937e+00   2.0395e+01  -1.1449e+01  -2.9160e+00   2.3327e+01  -6.6319e+00  -3.2852e+00  -3.2997e+00  -1.3358e+01  -1.1498e+01  -6.7381e+00  -1.4589e+01   8.9336e+00   6.9833e+00   7.0157e+00   1.0886e-02   1.1672e+01  -2.1346e+00  -2.3809e+01  -8.8848e+00  -2.5808e+00  -2.5977e+00  -2.2190e+01  -2.0748e+01  -1.0276e+01   1.1372e+01   1.4087e+01  -7.8510e+00  -7.6029e+00   9.8123e+00  -1.7401e+01   1.3829e+01   7.3379e+00   9.4500e-02   4.9520e+00   4.8767e+00  -2.7268e+00